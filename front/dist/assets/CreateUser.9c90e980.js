var ie=Object.defineProperty,ne=Object.defineProperties;var ue=Object.getOwnPropertyDescriptors;var E=Object.getOwnPropertySymbols;var de=Object.prototype.hasOwnProperty,ce=Object.prototype.propertyIsEnumerable;var M=(i,a,o)=>a in i?ie(i,a,{enumerable:!0,configurable:!0,writable:!0,value:o}):i[a]=o,I=(i,a)=>{for(var o in a||(a={}))de.call(a,o)&&M(i,o,a[o]);if(E)for(var o of E(a))ce.call(a,o)&&M(i,o,a[o]);return i},A=(i,a)=>ne(i,ue(a));import{g as me,u as J,r as l,j as u,a as t}from"./index.b0e91862.js";import{getRequest as $,postRequest as pe,putRequest as he}from"./Api.5a83ade6.js";import{T as fe}from"./TableListUser.a02183a2.js";import{S as ge}from"./SnackBarCustom.0cc24725.js";import{T as d,F as R,I as V}from"./TextField.5f6e7eb3.js";import{B as G}from"./Box.04ee3f33.js";import{S as H}from"./Select.c1216a27.js";import{M as n}from"./MenuItem.06d228b4.js";import{A as L}from"./Autocomplete.c23c8fec.js";import"./FileOpenTwoTone.ffde31c2.js";import"./jsx-runtime_commonjs-proxy.683ef609.js";import"./ButtonBase.4fe4f374.js";import"./Modal.3a8b8f7e.js";import"./TableRow.616f147f.js";import"./Grow.67318f79.js";import"./Toolbar.a09df885.js";import"./Close.fd9a01c4.js";import"./Menu.df74857a.js";import"./Popper.9c8e22b1.js";const P="users/";function je(i){let a=me();const f=J(e=>e.user).user,[b,N]=l.exports.useState(""),[x,k]=l.exports.useState(""),[C,c]=l.exports.useState(!1);function h(e,p){return new Promise((O,ve)=>{N(e),k(p),c(!0),O("Dados Atualizados")})}const[y,g]=l.exports.useState(""),[v,w]=l.exports.useState(""),[s,r]=l.exports.useState(""),[m,B]=l.exports.useState(""),[K,W]=l.exports.useState(!0),[U,F]=l.exports.useState(""),[Q,z]=l.exports.useState(!0),[T,D]=l.exports.useState(""),[X,j]=l.exports.useState(!0),[S,q]=l.exports.useState("");l.exports.useEffect(()=>{a.userid!=null?(console.log(1e3),Y()):(console.log(2e3),g(""),w(""),r(""),B(""),F(""),q(""),D(""),z(!1),W(!1),j(!1))},[a.userid]);const Y=()=>{$(`${P}${a.userid}`,localStorage.getItem("petdiniz-token")).then(e=>{g(a.userid),w(e.data.fullname),r(e.data.alias),F(e.data.usertype),D(e.data.username),B(e.data.status),z(f.usertype>e.data.usertype),W(f.usertype>e.data.usertype),j(!0)}).catch(e=>{navigate(`/home/${localStorage.getItem("petdiniz-token")}`)})},Z=()=>{switch(f.usertype){case 0:return[t(n,{value:0,children:"Administrador de Sistema"},0),t(n,{value:1,children:"Administrador"},1),t(n,{value:2,children:"Operador"},2),t(n,{value:3,children:"Cliente"},3)];case 1:return[t(n,{value:1,children:"Administrador"},1),t(n,{value:2,children:"Operador"},2),t(n,{value:3,children:"Cliente"},3)];case 2:return[t(n,{value:3,children:"Cliente"},3)]}},_=e=>{w(e.target.value)},ee=e=>{r(e.target.value)},te=e=>{q(e.target.value)},se=e=>{D(e.target.value.toLowerCase())},ae=e=>{B(e.target.value)},re=e=>{F(e.target.value)};function le(){return new Promise((e,p)=>{(v===""||s===""||m===""||U===""||T===""||S==="")&&(h("error","Favor preencher todos os campos").finally(()=>{console.log(v),console.log(s),console.log(m),console.log(U),console.log(T),console.log(S),setTimeout(()=>{c(!1)},3e3)}),p("Erro")),e("Tudo ok")})}const oe=()=>{var e={fullname:v,alias:s,status:m,username:T,password:S,userType:U};y==""?le().then(()=>{$(`users/validuser/${e.username}`,localStorage.getItem("petdiniz-token")).then(p=>{p.data?h("error","Nome de usuario j\xE1 existe").finally(()=>{setTimeout(()=>{c(!1)},3e3)}):pe(P,e,localStorage.getItem("petdiniz-token")).then(O=>{g(O.data.id),h("success","Usuario adicionado com sucesso").finally(()=>{setTimeout(()=>{c(!1)},3e3)})})})}):(e.id=parseInt(y),S===""&&delete e.password,console.log(e),he(P,e,localStorage.getItem("petdiniz-token")).then(p=>{g(p.data.id)}).then(()=>{h("success","Usuario editado com sucesso").finally(()=>{setTimeout(()=>{c(!1)},3e3)})}))};return u("div",{style:{width:"100%"},className:"formCreate",children:[t("div",{className:"form-rows form-row-1",children:t(d,{id:"userid",value:y,style:{width:"100px"},label:"ID:",disabled:!0,variant:"outlined"})}),u("div",{className:"form-rows form-row-2",children:[t(d,{id:"userfullname",autoComplete:"off",style:{maxWidth:600},value:v,onChange:_,label:"Nome:",variant:"outlined"}),t(d,{id:"useralias",autoComplete:"off",style:{maxWidth:400},value:s,onChange:ee,label:"Nome Amigavel:",variant:"outlined"}),t(G,{sx:{width:120},children:u(R,{fullWidth:!0,children:[t(V,{id:"userstatuslabel",children:"Status:"}),u(H,{labelId:"userstatuslabel",id:"userstatus",value:m,label:"Age",onChange:ae,disabled:K,defaultValue:3,children:[t(n,{value:0,children:"Inativo"}),t(n,{value:1,children:"Ativo"})]})]})}),t(G,{sx:{width:300},children:u(R,{fullWidth:!0,children:[t(V,{id:"usertypelabel",children:"Tipo de Usuario:"}),t(H,{labelId:"usertypelabel",id:"usertype",value:U,label:"Age",onChange:re,disabled:Q,children:Z()})]})})]}),u("div",{className:" form-rows form-row-2",children:[t(d,{id:"userusername",disabled:X,autoComplete:"off",style:{maxWidth:600},value:T,onChange:se,label:"Usuario:",variant:"outlined"}),t(d,{id:"userpassword",inputProps:{autoComplete:"new-password",form:{autoComplete:"off"}},type:"password",style:{maxWidth:400},value:S,onChange:te,label:"Senha:",variant:"outlined"})]}),t("div",{className:" form-rows form-row-4",children:t("button",{className:"btnSave",onClick:oe,children:"Salvar"})}),t(ge,{open:C,typeMessage:b,mensage:x})]})}function qe(i){const o=J(s=>s.user).user,[f,b]=l.exports.useState(null),[N,x]=l.exports.useState(null),[k,C]=l.exports.useState(null),[c,h]=l.exports.useState([]);return u("div",{className:"tableListItemArea",children:[u("div",{className:"filter",children:[t(L,{disablePortal:!0,id:"filterUser",options:c,onChange:(s,r)=>{r!=null?b(r.id):b(null)},sx:{width:"100%"},renderInput:s=>t(d,A(I({},s),{label:"Buscar por nome"}))}),t(L,{disablePortal:!0,id:"filterUser",options:[{id:0,label:"Inativo"},{id:1,label:"Ativo"}],isOptionEqualToValue:(s,r)=>s.id===r.id,onChange:(s,r)=>{r!=null?x(r.id):x(null)},sx:{width:200},renderInput:s=>t(d,A(I({},s),{label:"Status"}))}),t(L,{disablePortal:!0,id:"filterUser",options:[{id:0,label:"Super Administrador"},{id:1,label:"Administrador"},{id:2,label:"Operador"},{id:3,label:"Cliente"}],isOptionEqualToValue:(s,r)=>s.id===r.id,onChange:(s,r)=>{r!=null?C(r.id):C(null)},sx:{width:"100%"},renderInput:s=>t(d,A(I({},s),{label:"Tipo de usuario"}))})]}),t(fe,{userData:o,idFilter:f,statusFilter:N,userTypeFilter:k,columns:[{id:"id",label:"ID:",width:50},{id:"fullname",label:"Nome:",minWidth:200},{id:"alias",label:"Nome Amigavel:",width:150},{id:"username",label:"Nome de Usuario:",width:250},{id:"statusDescription",label:"Status:",width:200},{id:"usertypeLabel",label:"Tipo de Usuario:",minWidth:200}],handleUserList:s=>{const r=s.map(m=>({id:m.id,label:m.fullname}));h(r)}})]})}export{je as CreateUser,qe as ShowUsers};
