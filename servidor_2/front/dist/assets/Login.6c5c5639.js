import{l as x,u as y,r,p as z,j as p,a,S as B}from"./index.bdcc95c4.js";/* empty css                      */import{l as I}from"./petdiniz.868b0f8c.js";async function N(s,o){var t="";return s==null||s==""?t="O campo usuario n\xE3o pode estar vazio!":o==null||o==""?t="O campo senha n\xE3o pode estar vazio!":await x("login/",{username:s,password:o}).then(i=>{localStorage.setItem("petdiniz-token",i.data.token),t=`token:${i.data.token}`}).catch(i=>{t="Nome de usuario ou senha invalido"}),t}function E(){let s=y();const[o,t]=r.exports.useState(""),[c,i]=r.exports.useState(""),[g,m]=r.exports.useState(""),[k,f]=r.exports.useState(""),[h,u]=r.exports.useState(!1);r.exports.useEffect(()=>{v()},[]);async function v(){if(localStorage.getItem("petdiniz-token")!=null)try{const e=await z("/login/validatetoken",{token:localStorage.getItem("petdiniz-token")},localStorage.getItem("petdiniz-token"));e!=null&&e.status==200&&s(`/home/${localStorage.getItem("petdiniz-token")}`)}catch{console.log("Token Invalido")}}function d(e,n){return new Promise((l,A)=>{m(e),f(n),u(!0),l("Dados Atualizados")})}function S(e){N(o,c).then(n=>{if(n.substring(0,5)=="token"){const l=n;d("success","Login efetuado com sucesso!").then(()=>{setTimeout(()=>{u(!1)},2e3)}).then(()=>{console.log(l),setTimeout(()=>s(`/validalogin/${l.split(":")[1]}`),2e3)})}else d("error",n).finally(()=>{setTimeout(()=>{u(!1)},3e3)})}).catch(n=>{console.log("Erro")})}return p("div",{className:"loginArea",children:[a(B,{open:h,typeMessage:g,mensage:k}),a("div",{className:"logoArea",children:a("img",{src:I,alt:"logo"})}),p("div",{className:"userPassArea",children:[a("div",{className:"userArea",children:a("input",{type:"text",name:"userInput",id:"userInput",placeholder:"Usuario",value:o,onChange:e=>t(e.target.value.toLowerCase())})}),a("div",{className:"passArea",children:a("input",{type:"password",name:"userPassword",id:"userPassword",placeholder:"Senha",value:c,onChange:e=>i(e.target.value)})}),a("button",{className:"btnLogin",onClick:S,children:"Entrar"})]})]})}export{E as default};
